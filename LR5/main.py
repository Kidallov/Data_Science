import numpy as np
from scipy.optimize import linprog
import matplotlib.pyplot as plt
from matplotlib.patches import Polygon, FancyBboxPatch, FancyArrowPatch


def solve_production_optimization():
    """
    –ó–ê–î–ê–ß–ê 1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏
    –ú–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–∏–±—ã–ª–∏ –∫–æ–º–ø–∞–Ω–∏–∏ –ø—Ä–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö
    """
    print("=" * 70)
    print("–ó–ê–î–ê–ß–ê 1: –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ü–†–û–ò–ó–í–û–î–°–¢–í–ê –≠–õ–ï–ö–¢–†–û–ù–ò–ö–ò")
    print("=" * 70)

    # –ú–ê–¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ú–û–î–ï–õ–¨
    print("\n--- –ú–ê–¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ú–û–î–ï–õ–¨ ---")
    print("–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:")
    print("  x‚ÇÅ - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–æ–≤")
    print("  x‚ÇÇ - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞–Ω—à–µ—Ç–æ–≤")
    print("\n–¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è:")
    print("  P = 8000*x‚ÇÅ + 12000*x‚ÇÇ ‚Üí max")
    print("\n–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:")
    print("  2x‚ÇÅ + 3x‚ÇÇ ‚â§ 240  (–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–µ –≤—Ä–µ–º—è)")
    print("  4x‚ÇÅ + 6x‚ÇÇ ‚â§ 480  (–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å)")
    print("  1x‚ÇÅ + 2x‚ÇÇ ‚â§ 150  (–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã)")
    print("  x‚ÇÅ ‚â• 0, x‚ÇÇ ‚â• 0")

    # –†–ï–®–ï–ù–ò–ï –ó–ê–î–ê–ß–ò
    print("\n--- –†–ï–®–ï–ù–ò–ï –ó–ê–î–ê–ß–ò ---")

    # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (–¥–ª—è –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–∏–Ω—É—Å)
    c = [-8000, -12000]

    # –ú–∞—Ç—Ä–∏—Ü–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π-–Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤
    A_ub = [
        [2, 3],  # –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–µ –≤—Ä–µ–º—è
        [4, 6],  # –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å
        [1, 2]  # –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã
    ]
    b_ub = [240, 480, 150]

    # –ì—Ä–∞–Ω–∏—Ü—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    bounds = [(0, None), (0, None)]

    # –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ª–∏–Ω–µ–π–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
    result = linprog(c, A_ub=A_ub, b_ub=b_ub, bounds=bounds, method='highs')

    # –í–´–í–û–î –†–ï–ó–£–õ–¨–¢–ê–¢–û–í
    if result.success:
        optimal_x1, optimal_x2 = result.x
        max_profit = -result.fun

        print(f"‚úì –°—Ç–∞—Ç—É—Å —Ä–µ—à–µ–Ω–∏—è: {result.message}")
        print(f"\nüìä –û–ü–¢–ò–ú–ê–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï:")
        print(f"  ‚Ä¢ –°–º–∞—Ä—Ç—Ñ–æ–Ω–æ–≤: {optimal_x1:.0f} —à—Ç.")
        print(f"  ‚Ä¢ –ü–ª–∞–Ω—à–µ—Ç–æ–≤: {optimal_x2:.0f} —à—Ç.")
        print(f"  ‚Ä¢ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å: {max_profit:,.0f} —Ä—É–±.")

        # –ê–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
        print(f"\nüîç –ê–ù–ê–õ–ò–ó –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø –†–ï–°–£–†–°–û–í:")
        cpu_used = 2 * optimal_x1 + 3 * optimal_x2
        mem_used = 4 * optimal_x1 + 6 * optimal_x2
        batt_used = 1 * optimal_x1 + 2 * optimal_x2

        resources = [
            ("–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–µ –≤—Ä–µ–º—è", cpu_used, 240),
            ("–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å", mem_used, 480),
            ("–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã", batt_used, 150)
        ]

        for name, used, total in resources:
            status = "üü¢ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è" if abs(used - total) < 0.1 else "üü° –ù–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é"
            print(f"  ‚Ä¢ {name}: {used:.1f} –∏–∑ {total} ({used / total * 100:.1f}%) - {status}")

        # –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø
        visualize_production_solution(optimal_x1, optimal_x2, A_ub, b_ub)

    else:
        print(f"‚úó –û—à–∏–±–∫–∞ —Ä–µ—à–µ–Ω–∏—è: {result.message}")

    return result


def visualize_production_solution(optimal_x1, optimal_x2, A_ub, b_ub):
    """
    –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞
    """
    fig, ax = plt.subplots(figsize=(12, 8))

    # –î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    x1_range = np.linspace(0, 150, 400)

    # –ì—Ä–∞–Ω–∏—Ü—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (–≤—ã—Ä–∞–∂–∞–µ–º x‚ÇÇ —á–µ—Ä–µ–∑ x‚ÇÅ)
    x2_cpu = (b_ub[0] - A_ub[0][0] * x1_range) / A_ub[0][1]  # –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–µ –≤—Ä–µ–º—è
    x2_mem = (b_ub[1] - A_ub[1][0] * x1_range) / A_ub[1][1]  # –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å
    x2_batt = (b_ub[2] - A_ub[2][0] * x1_range) / A_ub[2][1]  # –ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã

    # –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ª–∏–Ω–∏–π –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
    ax.plot(x1_range, x2_cpu, label='2x‚ÇÅ + 3x‚ÇÇ ‚â§ 240 (–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ–µ –≤—Ä–µ–º—è)',
            linewidth=2, color='blue')
    ax.plot(x1_range, x2_mem, label='4x‚ÇÅ + 6x‚ÇÇ ‚â§ 480 (–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å)',
            linewidth=2, color='green')
    ax.plot(x1_range, x2_batt, label='x‚ÇÅ + 2x‚ÇÇ ‚â§ 150 (–∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã)',
            linewidth=2, color='red')

    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä—à–∏–Ω –¥–æ–ø—É—Å—Ç–∏–º–æ–π –æ–±–ª–∞—Å—Ç–∏
    vertices = []
    vertices.append((0, 0))  # –ù–∞—á–∞–ª–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
    vertices.append((0, min(x2_cpu[0], x2_mem[0], x2_batt[0])))  # –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å –æ—Å—å—é y
    vertices.append((optimal_x1, optimal_x2))  # –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞
    vertices.append((min(b_ub[0] / 2, b_ub[1] / 4, b_ub[2] / 1), 0))  # –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å –æ—Å—å—é x

    # –ó–∞–∫—Ä–∞—à–∏–≤–∞–Ω–∏–µ –¥–æ–ø—É—Å—Ç–∏–º–æ–π –æ–±–ª–∞—Å—Ç–∏
    polygon = Polygon(vertices, alpha=0.3, color='lightblue',
                      label='–î–æ–ø—É—Å—Ç–∏–º–∞—è –æ–±–ª–∞—Å—Ç—å')
    ax.add_patch(polygon)

    # –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞
    ax.plot(optimal_x1, optimal_x2, 'ro', markersize=10,
            label=f'–û–ø—Ç–∏–º—É–º: ({optimal_x1:.0f}, {optimal_x2:.0f})')

    # –õ–∏–Ω–∏–∏ —É—Ä–æ–≤–Ω—è —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (–∏–∑–æ–ø—Ä–æ—Ñ–∏—Ç—ã)
    profit_levels = [400000, 600000, -linprog([-8000, -12000],
                                              A_ub=A_ub, b_ub=b_ub, bounds=[(0, None), (0, None)]).fun]

    for level in profit_levels:
        x2_profit = (level - 8000 * x1_range) / 12000
        ax.plot(x1_range, x2_profit, '--', alpha=0.5,
                label=f'–ü—Ä–∏–±—ã–ª—å: {level / 1000:.0f} —Ç—ã—Å. —Ä—É–±.')

    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞
    ax.set_xlabel('x‚ÇÅ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–æ–≤)', fontsize=12)
    ax.set_ylabel('x‚ÇÇ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–ª–∞–Ω—à–µ—Ç–æ–≤)', fontsize=12)
    ax.set_title('–ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞',
                 fontsize=14, fontweight='bold')
    ax.legend()
    ax.grid(True, alpha=0.3)
    ax.set_xlim(0, 150)
    ax.set_ylim(0, 100)

    plt.tight_layout()
    plt.savefig('production_optimization.png', dpi=300, bbox_inches='tight')
    plt.show()


def solve_transport_problem():
    """
    –ó–ê–î–ê–ß–ê 2: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–Ω–∞–±–∂–µ–Ω–∏—è –≤–æ–µ–Ω–Ω—ã—Ö –±–∞–∑
    –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –ø—Ä–∏ —Å–Ω–∞–±–∂–µ–Ω–∏–∏ –±–∞–∑
    """
    print("\n" + "=" * 70)
    print("–ó–ê–î–ê–ß–ê 2: –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –°–ù–ê–ë–ñ–ï–ù–ò–Ø –í–û–ï–ù–ù–´–• –ë–ê–ó")
    print("=" * 70)

    # –ú–ê–¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ú–û–î–ï–õ–¨
    print("\n--- –ú–ê–¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ú–û–î–ï–õ–¨ ---")
    print("–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:")
    print("  x‚ÇÅ‚ÇÅ - –ø–µ—Ä–µ–≤–æ–∑–∫–∏ –°–∫–ª–∞–¥ 1 ‚Üí –ë–∞–∑–∞ –ê–ª—å—Ñ–∞")
    print("  x‚ÇÅ‚ÇÇ - –ø–µ—Ä–µ–≤–æ–∑–∫–∏ –°–∫–ª–∞–¥ 1 ‚Üí –ë–∞–∑–∞ –ë–µ—Ç–∞")
    print("  x‚ÇÅ‚ÇÉ - –ø–µ—Ä–µ–≤–æ–∑–∫–∏ –°–∫–ª–∞–¥ 1 ‚Üí –ë–∞–∑–∞ –ì–∞–º–º–∞")
    print("  x‚ÇÇ‚ÇÅ - –ø–µ—Ä–µ–≤–æ–∑–∫–∏ –°–∫–ª–∞–¥ 2 ‚Üí –ë–∞–∑–∞ –ê–ª—å—Ñ–∞")
    print("  x‚ÇÇ‚ÇÇ - –ø–µ—Ä–µ–≤–æ–∑–∫–∏ –°–∫–ª–∞–¥ 2 ‚Üí –ë–∞–∑–∞ –ë–µ—Ç–∞")
    print("  x‚ÇÇ‚ÇÉ - –ø–µ—Ä–µ–≤–æ–∑–∫–∏ –°–∫–ª–∞–¥ 2 ‚Üí –ë–∞–∑–∞ –ì–∞–º–º–∞")

    print("\n–¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è:")
    print("  Z = 8x‚ÇÅ‚ÇÅ + 6x‚ÇÅ‚ÇÇ + 10x‚ÇÅ‚ÇÉ + 9x‚ÇÇ‚ÇÅ + 7x‚ÇÇ‚ÇÇ + 5x‚ÇÇ‚ÇÉ ‚Üí min")

    print("\n–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Å–∫–ª–∞–¥–∞–º:")
    print("  x‚ÇÅ‚ÇÅ + x‚ÇÅ‚ÇÇ + x‚ÇÅ‚ÇÉ = 150")
    print("  x‚ÇÇ‚ÇÅ + x‚ÇÇ‚ÇÇ + x‚ÇÇ‚ÇÉ = 250")

    print("\n–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –±–∞–∑–∞–º:")
    print("  x‚ÇÅ‚ÇÅ + x‚ÇÇ‚ÇÅ = 120")
    print("  x‚ÇÅ‚ÇÇ + x‚ÇÇ‚ÇÇ = 180")
    print("  x‚ÇÅ‚ÇÉ + x‚ÇÇ‚ÇÉ = 100")

    # –†–ï–®–ï–ù–ò–ï –ó–ê–î–ê–ß–ò
    print("\n--- –†–ï–®–ï–ù–ò–ï –ó–ê–î–ê–ß–ò ---")

    # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Ü–µ–ª–µ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ (—Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–≤–æ–∑–æ–∫)
    c = [8, 6, 10, 9, 7, 5]

    # –ú–∞—Ç—Ä–∏—Ü–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π-—Ä–∞–≤–µ–Ω—Å—Ç–≤
    A_eq = [
        [1, 1, 1, 0, 0, 0],  # –°–∫–ª–∞–¥ 1
        [0, 0, 0, 1, 1, 1],  # –°–∫–ª–∞–¥ 2
        [1, 0, 0, 1, 0, 0],  # –ë–∞–∑–∞ –ê–ª—å—Ñ–∞
        [0, 1, 0, 0, 1, 0],  # –ë–∞–∑–∞ –ë–µ—Ç–∞
        [0, 0, 1, 0, 0, 1]  # –ë–∞–∑–∞ –ì–∞–º–º–∞
    ]

    b_eq = [150, 250, 120, 180, 100]

    # –ì—Ä–∞–Ω–∏—Ü—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
    bounds = [(0, None) for _ in range(6)]

    # –†–µ—à–µ–Ω–∏–µ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏
    result = linprog(c, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')

    # –í–´–í–û–î –†–ï–ó–£–õ–¨–¢–ê–¢–û–í
    if result.success:
        x11, x12, x13, x21, x22, x23 = result.x
        min_cost = result.fun

        print(f"‚úì –°—Ç–∞—Ç—É—Å —Ä–µ—à–µ–Ω–∏—è: {result.message}")

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏
        total_supply = 150 + 250
        total_demand = 120 + 180 + 100
        balanced = abs(total_supply - total_demand) < 0.1

        print(f"\n‚öñÔ∏è  –ü–†–û–í–ï–†–ö–ê –°–ë–ê–õ–ê–ù–°–ò–†–û–í–ê–ù–ù–û–°–¢–ò:")
        print(f"  ‚Ä¢ –û–±—â–∏–π –∑–∞–ø–∞—Å: {total_supply} —Ç–æ–Ω–Ω")
        print(f"  ‚Ä¢ –û–±—â–∞—è –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å: {total_demand} —Ç–æ–Ω–Ω")
        print(f"  ‚Ä¢ –ó–∞–¥–∞—á–∞ {'—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∞ ‚úÖ' if balanced else '–Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∞ ‚ùå'}")

        print(f"\nüìä –û–ü–¢–ò–ú–ê–õ–¨–ù–´–ô –ü–õ–ê–ù –ü–ï–†–ï–í–û–ó–û–ö:")
        routes = [
            ("–°–∫–ª–∞–¥ 1 ‚Üí –ë–∞–∑–∞ –ê–ª—å—Ñ–∞", x11, 8),
            ("–°–∫–ª–∞–¥ 1 ‚Üí –ë–∞–∑–∞ –ë–µ—Ç–∞", x12, 6),
            ("–°–∫–ª–∞–¥ 1 ‚Üí –ë–∞–∑–∞ –ì–∞–º–º–∞", x13, 10),
            ("–°–∫–ª–∞–¥ 2 ‚Üí –ë–∞–∑–∞ –ê–ª—å—Ñ–∞", x21, 9),
            ("–°–∫–ª–∞–¥ 2 ‚Üí –ë–∞–∑–∞ –ë–µ—Ç–∞", x22, 7),
            ("–°–∫–ª–∞–¥ 2 ‚Üí –ë–∞–∑–∞ –ì–∞–º–º–∞", x23, 5)
        ]

        for route, volume, cost in routes:
            if volume > 0.1:
                print(f"  ‚Ä¢ {route}: {volume:.1f} —Ç–æ–Ω–Ω (—Å—Ç–æ–∏–º–æ—Å—Ç—å: {cost} –µ–¥./—Ç–æ–Ω–Ω–∞)")

        print(f"\nüí∞ –ú–ò–ù–ò–ú–ê–õ–¨–ù–ê–Ø –°–¢–û–ò–ú–û–°–¢–¨: {min_cost:.0f} —É—Å–ª. –µ–¥.")

        # –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        analyze_transport_solution(x11, x12, x13, x21, x22, x23, routes)

        # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
        visualize_transport_network(x11, x12, x13, x21, x22, x23, routes)

    else:
        print(f"‚úó –û—à–∏–±–∫–∞ —Ä–µ—à–µ–Ω–∏—è: {result.message}")

    return result


def analyze_transport_solution(x11, x12, x13, x21, x22, x23, routes):
    """
    –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏
    """
    print(f"\nüîç –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –†–ï–ó–£–õ–¨–¢–ê–¢–û–í:")

    print(f"\nüì¶ –ò–°–ü–û–õ–¨–ó–£–ï–ú–´–ï –ú–ê–†–®–†–£–¢–´:")
    used_routes = [(route, vol, cost) for route, vol, cost in routes if vol > 0.1]
    for route, volume, cost in used_routes:
        print(f"  ‚Ä¢ {route}: {volume:.1f} —Ç–æ–Ω–Ω")

    print(f"\nüö´ –ù–ï–ò–°–ü–û–õ–¨–ó–£–ï–ú–´–ï –ú–ê–†–®–†–£–¢–´:")
    unused_routes = [(route, cost) for route, vol, cost in routes if vol <= 0.1]
    for route, cost in unused_routes:
        print(f"  ‚Ä¢ {route} (—Å—Ç–æ–∏–º–æ—Å—Ç—å: {cost} –µ–¥.)")

    print(f"\nüéØ –í–´–ü–û–õ–ù–ï–ù–ò–ï –ü–û–°–¢–ê–í–û–ö –ü–û –ë–ê–ó–ê–ú:")
    print(f"  ‚Ä¢ –ë–∞–∑–∞ –ê–ª—å—Ñ–∞: {x11 + x21:.1f} –∏–∑ 120 —Ç–æ–Ω–Ω ({((x11 + x21) / 120 * 100):.1f}%)")
    print(f"  ‚Ä¢ –ë–∞–∑–∞ –ë–µ—Ç–∞: {x12 + x22:.1f} –∏–∑ 180 —Ç–æ–Ω–Ω ({((x12 + x22) / 180 * 100):.1f}%)")
    print(f"  ‚Ä¢ –ë–∞–∑–∞ –ì–∞–º–º–∞: {x13 + x23:.1f} –∏–∑ 100 —Ç–æ–Ω–Ω ({((x13 + x23) / 100 * 100):.1f}%)")

    print(f"\nüè≠ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –°–ö–õ–ê–î–û–í:")
    print(f"  ‚Ä¢ –°–∫–ª–∞–¥ 1: {x11 + x12 + x13:.1f} –∏–∑ 150 —Ç–æ–Ω–Ω ({((x11 + x12 + x13) / 150 * 100):.1f}%)")
    print(f"  ‚Ä¢ –°–∫–ª–∞–¥ 2: {x21 + x22 + x23:.1f} –∏–∑ 250 —Ç–æ–Ω–Ω ({((x21 + x22 + x23) / 250 * 100):.1f}%)")


def visualize_transport_network(x11, x12, x13, x21, x22, x23, routes):
    """
    –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ç–µ–≤–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏
    """
    fig, ax = plt.subplots(figsize=(14, 10))

    # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —É–∑–ª–æ–≤
    warehouses = {
        '–°–∫–ª–∞–¥ 1': {'pos': (2, 8), 'supply': 150},
        '–°–∫–ª–∞–¥ 2': {'pos': (2, 3), 'supply': 250}
    }

    bases = {
        '–ê–ª—å—Ñ–∞': {'pos': (10, 10), 'demand': 120},
        '–ë–µ—Ç–∞': {'pos': (10, 5.5), 'demand': 180},
        '–ì–∞–º–º–∞': {'pos': (10, 1), 'demand': 100}
    }

    # –†–∏—Å—É–µ–º —Å–∫–ª–∞–¥—ã
    for name, info in warehouses.items():
        pos = info['pos']
        supply = info['supply']

        ax.add_patch(FancyBboxPatch(
            (pos[0] - 1, pos[1] - 0.5), 2, 1,
            boxstyle="round,pad=0.1",
            facecolor='lightgreen',
            edgecolor='darkgreen',
            linewidth=2
        ))
        ax.text(pos[0], pos[1], f"{name}\n–ó–∞–ø–∞—Å: {supply}—Ç",
                ha='center', va='center', fontsize=10, fontweight='bold')

    # –†–∏—Å—É–µ–º –±–∞–∑—ã
    for name, info in bases.items():
        pos = info['pos']
        demand = info['demand']

        ax.add_patch(FancyBboxPatch(
            (pos[0] - 1, pos[1] - 0.5), 2, 1,
            boxstyle="round,pad=0.1",
            facecolor='lightcoral',
            edgecolor='darkred',
            linewidth=2
        ))
        ax.text(pos[0], pos[1], f"–ë–∞–∑–∞ {name}\n–ü–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç—å: {demand}—Ç",
                ha='center', va='center', fontsize=10, fontweight='bold')

    # –†–∏—Å—É–µ–º –ø–æ—Ç–æ–∫–∏ –ø–µ—Ä–µ–≤–æ–∑–æ–∫
    flows = [
        ('–°–∫–ª–∞–¥ 1', '–ê–ª—å—Ñ–∞', x11, 8),
        ('–°–∫–ª–∞–¥ 1', '–ë–µ—Ç–∞', x12, 6),
        ('–°–∫–ª–∞–¥ 1', '–ì–∞–º–º–∞', x13, 10),
        ('–°–∫–ª–∞–¥ 2', '–ê–ª—å—Ñ–∞', x21, 9),
        ('–°–∫–ª–∞–¥ 2', '–ë–µ—Ç–∞', x22, 7),
        ('–°–∫–ª–∞–¥ 2', '–ì–∞–º–º–∞', x23, 5)
    ]

    for flow in flows:
        if flow[2] > 0.1:  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–µ–Ω—É–ª–µ–≤—ã–µ –ø–æ—Ç–æ–∫–∏
            start = warehouses[flow[0]]['pos']
            end = bases[flow[1]]['pos']

            # –¢–æ–ª—â–∏–Ω–∞ —Å—Ç—Ä–µ–ª–∫–∏ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ –æ–±—ä–µ–º—É –ø–µ—Ä–µ–≤–æ–∑–æ–∫
            linewidth = max(1, flow[2] / 20)

            # –†–∏—Å—É–µ–º —Å—Ç—Ä–µ–ª–∫—É
            arrow = FancyArrowPatch(
                start, end,
                arrowstyle='->',
                linewidth=linewidth,
                color='blue',
                alpha=0.7,
                mutation_scale=20
            )
            ax.add_patch(arrow)

            # –ü–æ–¥–ø–∏—Å—å –ø–æ—Ç–æ–∫–∞
            mid_x = (start[0] + end[0]) / 2
            mid_y = (start[1] + end[1]) / 2
            ax.text(mid_x, mid_y, f'{flow[2]:.0f}—Ç\n({flow[3]} –µ–¥.)',
                    ha='center', va='center', fontsize=8,
                    bbox=dict(boxstyle="round,pad=0.2",
                              facecolor='white', alpha=0.8))

    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∞
    ax.set_xlim(0, 12)
    ax.set_ylim(0, 12)
    ax.set_aspect('equal')
    ax.axis('off')
    ax.set_title('–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω —Å–Ω–∞–±–∂–µ–Ω–∏—è –≤–æ–µ–Ω–Ω—ã—Ö –±–∞–∑\n(–°–µ—Ç–µ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏)',
                 fontsize=16, fontweight='bold')

    plt.tight_layout()
    plt.savefig('transport_network.png', dpi=300, bbox_inches='tight')
    plt.show()


def main():
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã
    """
    print("–õ–ê–ë–û–†–ê–¢–û–†–ù–ê–Ø –†–ê–ë–û–¢–ê: –õ–ò–ù–ï–ô–ù–û–ï –ü–†–û–ì–†–ê–ú–ú–ò–†–û–í–ê–ù–ò–ï")
    print("–í –ó–ê–î–ê–ß–ê–• –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò")
    print("–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞: –û—Å–Ω–æ–≤—ã Data Science")
    print("–î–∞—Ç–∞: 21 –æ–∫—Ç—è–±—Ä—è 2025 –≥.")
    print("\n" + "=" * 70)

    # –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ 1
    production_result = solve_production_optimization()

    # –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ 2
    transport_result = solve_transport_problem()

    # –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥
    print("\n" + "=" * 70)
    print("–ò–¢–û–ì–ò –í–´–ü–û–õ–ù–ï–ù–ò–Ø –õ–ê–ë–û–†–ê–¢–û–†–ù–û–ô –†–ê–ë–û–¢–´")
    print("=" * 70)
    print("‚úì –ó–∞–¥–∞—á–∞ 1 (–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞): –†–ï–®–ï–ù–ê")
    print("‚úì –ó–∞–¥–∞—á–∞ 2 (–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞): –†–ï–®–ï–ù–ê")
    print("‚úì –ü–æ—Å—Ç—Ä–æ–µ–Ω—ã –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏")
    print("‚úì –ü—Ä–æ–≤–µ–¥–µ–Ω –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤")
    print("‚úì –°–æ–∑–¥–∞–Ω—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏")
    print("\n–ì—Ä–∞—Ñ–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª—ã:")
    print("  ‚Ä¢ production_optimization.png")
    print("  ‚Ä¢ transport_network.png")


if __name__ == "__main__":
    main()